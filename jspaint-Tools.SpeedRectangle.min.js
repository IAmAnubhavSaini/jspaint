/*! jspaint 2015-07-15 Anubhav Saini (c) 2015 */
$(function(){"use strict";var a={CONSTANTS:{id:"SpeedRectangleTool",selectionId:"#SpeedRectangleTool","class":"main-tool",title:"Click to draw speed rectangles. Click again to disable."},VARIABLES:{length:20,breadth:10},start:function(b){var c=(b.event,"#"+b.canvasId);$(c).on("mousemove",function(b){var d={event:b,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=a.VARIABLES.length,h=a.VARIABLES.breadth;context.fillRect(e-g/2,f-h/2,g,h)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c(b.lengthId,b.lengthTitle).attr("value",a.VARIABLES.length).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.length=$(this).val()}).appendTo(d),c(b.breadthId,b.breadthTitle).attr("value",a.VARIABLES.breadth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.breadth=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(b){function c(a){$("#"+a.lengthId).remove(),$("#"+a.breadthId).remove()}c(b),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"SpeedRectangleContextMenu",lengthId:"lengthSpeedRectangle",breadthId:"breadthSpeedRectangle",lengthTitle:"length for speed rectangle",breadthTitle:"breadth for speed rectangle",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed rectangle"})});