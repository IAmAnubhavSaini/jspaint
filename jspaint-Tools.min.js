/*! jspaint 2015-08-26 Anubhav Saini (c) 2015 */
$(function(){"use strict";var a={CONSTANTS:{id:"MandelbrotFractalTool",selectionId:"#MandelbrotFractalTool","class":"main-tool",title:"Click to draw Mandelbrot Fractal. Click again to disable.",maxHeight:-1,maxWidth:-1},VARIABLES:{iterations:1e3,xMax:1,yMax:1,xMin:-2,yMin:-1,height:-1,width:-1},start:function(b){function c(b){function c(a,b,c){for(var d=0,e=0,f=0,g=0,h=0,i=c;i--&&4>=f+g;)h=d*e,f=d*d,g=e*e,d=f-g+a,e=h+h+b;return c-i}function d(b){var d,e,f,g,h,i,j,k=b.context,l=b.XMin,m=b.YMin,n=b.XMax,o=b.YMax,p=b.iterations,q=a.VARIABLES.width,r=a.VARIABLES.height,s=k.getImageData(0,0,q,r),t=s.data,u=Color.hexToRgb(selectedPrimaryColor);for(d=0;q>d;++d)for(e=0;r>e;++e)f=l+(n-l)*d/(q-1),g=m+(o-m)*e/(r-1),h=c(f,g,p),j=4*(q*e+d),h>p?(t[j]=u.r,t[j+1]=u.g,t[j+2]=u.b):(i=3*Math.log(h)/Math.log(p-1),1>i?(t[j]=255*i,t[j+1]=0,t[j+2]=0):2>i?(t[j]=255,t[j+1]=255*(i-1),t[j+2]=0):(t[j]=255,t[j+1]=255,t[j+2]=255*(i-2))),t[j+3]=255;k.putImageData(s,b.startX,b.startY)}d(b)}var d=b.event,e=b.canvasId,f=function(b){return b+Math.floor(a.VARIABLES.width)-a.CONSTANTS.maxWidth},g=function(b){var c=Actions.Mouse.getX(b),d=Math.max(c-Math.floor(a.VARIABLES.width/2),0),e=f(d);return e>0&&(d-=e),d},h=function(b){return b+Math.floor(a.VARIABLES.height)-a.CONSTANTS.maxHeight},i=function(b){var c=Actions.Mouse.getY(b),d=Math.max(c-Math.floor(a.VARIABLES.height/2),0),e=h(d);return e>0&&(d-=e),d};$(e).on(d,function(b){var d={event:b,relativeTo:$(e)},f=g(d),h=i(d);c({context:context,XMin:a.VARIABLES.xMin,XMax:a.VARIABLES.xMax,YMin:a.VARIABLES.yMin,YMax:a.VARIABLES.yMax,iterations:a.VARIABLES.iterations,startX:f,startY:h})})},stop:function(a){$(a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b,c,d){return $('<input id="'+a+'" type="range" min="'+b+'" max="'+c+'" step="1" title="'+d+'" />')}function d(b){function d(b){var d=c("mandelbrotIterations","10",b.maxIterationsAllowed,"Iterations for mandelbrot fractal generation. Beware! If higher values are used, it might crash your browser.").attr("value",a.VARIABLES.iterations).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var c=$(this).val();c>b.maxIterationsAllowed&&confirm("Beware! It might crash your browser. Go back?","back","No, I want these many iterations. I know what I am doing!")&&(c=b.maxIterationsAllowed),a.VARIABLES.iterations=c});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.iterationLabel).append(d(b));return e}function e(b){function d(b){var d=c("mandelbrotHeight","100",a.CONSTANTS.maxHeight,"Height for mandelbrot fractal generation.").attr("value",a.CONSTANTS.maxHeight).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var b=$(this).val();b>a.CONSTANTS.maxHeight&&(b=a.CONSTANTS.maxHeight),a.VARIABLES.height=b});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.heightLabel).append(d(b));return e}function f(b){function d(b){var d=c("mandelbrotWidth","100",a.CONSTANTS.maxWidth,"Width for mandelbrot fractal generation.").attr("value",a.CONSTANTS.maxWidth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var b=$(this).val();b>a.CONSTANTS.maxWidth&&(b=a.CONSTANTS.maxWidth),a.VARIABLES.width=b});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.widthLabel).append(d(b));return e}function g(b){function d(b){var d=c("mandelbrotXMax","0","3","XMax for mandelbrot fractal generation.").attr("value","1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){a.VARIABLES.xMax=$(this).val()});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.xMaxLabel).append(d(b));return e}function h(b){function d(b){var d=c("mandelbrotYMax","0","3","YMax for mandelbrot fractal generation.").attr("value","1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){a.VARIABLES.yMax=$(this).val()});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.yMaxLabel).append(d(b));return e}function i(b){function d(b){var d=c("mandelbrotXMin","-3","1","XMin for mandelbrot fractal generation.").attr("value","-2").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){a.VARIABLES.xMin=$(this).val()});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.xMinLabel).append(d(b));return e}function j(b){function d(b){var d=c("mandelbrotYMin","-2","1","YMin for mandelbrot fractal generation.").attr("value","-1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){a.VARIABLES.yMin=$(this).val()});return d}var e=$('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.yMinLabel).append(d(b));return e}var k=$("<div></div>").attr("id",b.id).addClass("menu-item");k.append(d(b)),k.append(e(b)),k.append(f(b)),k.append(g(b)),k.append(h(b)),k.append(i(b)),k.append(j(b)),k.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"MandelbrotFractalContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxIterationsAllowed:2e3,minIterationsAllowed:10,iterationLabel:"Iterations: ",maxHeightAllowed:a.VARIABLES.maxHeight,heightLabel:"Height: ",maxWidthAllowed:a.VARIABLES.maxWidth,widthLabel:"Width: ",xMaxLabel:"XMax: ",yMaxLabel:"YMax: ",xMinLabel:"XMin: ",yMinLabel:"YMin: "}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),a.VARIABLES.height=a.CONSTANTS.maxHeight=$(b.canvasId)[0].height,a.VARIABLES.width=a.CONSTANTS.maxWidth=$(b.canvasId)[0].width,e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:"#"+CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Mandelbrot fractal"})}),$(function(){"use strict";var a={CONSTANTS:{id:"PencilTool",selectionId:"#PencilTool","class":"main-tool",title:"Click to draw free-hand lines. Click again to disable."},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(b){var c=b.event,d="#"+b.canvasId,e=null,f=null,g=null,h=null,i=null,j={get:function(){return{X:a.VARIABLES.LastPoint.X,Y:a.VARIABLES.LastPoint.Y}},set:function(b,c){a.VARIABLES.LastPoint.X=b,a.VARIABLES.LastPoint.Y=c}};$(d).on(c,function(b){e={event:b,relativeTo:$(this)};var c=function(){f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.width,i=j.get(),-1!=i.X&&CANVASAPI.drawLineSegmentFromLastPoint({context:context,last:i,current:{X:f,Y:g},width:h}),j.set(f,g)};void 0!==b.buttons&&(1===b.buttons?c():(a.VARIABLES.LastPoint.X=-1,a.VARIABLES.LastPoint.Y=-1))})},stop:function(a){var b=a.event||CONSTANTS.Events.mousemove,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function c(){return $('<input id="widthPencil" type="range" min="1" max="200" step="1" title="width for pencil tool." />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c().attr("value",a.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.width=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"PencilContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Pencil"})}),$(function(){"use strict";var a={CONSTANTS:{id:"pick-color",selectionId:"#pick-color","class":"string-menu-item",containerId:"PickColorTool",title:"Click to pick color under mouse pointer tip; picks until some other tool is selected. Click again to disable."},start:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId),d=null,e=null,f=null,g=null,h=0,i=0,j=0,k=0;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=context.getImageData(e-.5,f-.5,e+.5,f+.5).data,h=g[0],i=g[1],j=g[2],k=g[3],selectedPrimaryColor=context.fillStyle="rgba("+h+", "+i+", "+j+", "+k+")"})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},Events:{register:function(b){var c=b.toolId,d=$(c);setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b)},function(){deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,containerId:a.CONSTANTS.containerId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Color picker"})}),$(function(){"use strict";var a={CONSTANTS:{id:"PivotedLinePatternTool",selectionId:"#PivotedLinePatternTool","class":"main-tool",title:"Click to draw amazing pattern. Click again to disable.",ACTIONS:{pivots:"pivots",Ydrops:"drops",godRays:"god-rays",Xextends:"extends"}},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(b){var c=b.event||CONSTANTS.Events.mousemove,d="#"+(b.canvasId||CONSTANTS.canvasId),e=null,f=null,g=null,h=null,i=null,j={get:function(){return{X:a.VARIABLES.LastPoint.X,Y:a.VARIABLES.LastPoint.Y}},set:function(b,c){a.VARIABLES.LastPoint.X=b,a.VARIABLES.LastPoint.Y=c}},k=null;$(d).on(c,function(b){e={event:b,relativeTo:$(this)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),k=$("[name=tool-options]:checked").val();var c=function(){h=a.VARIABLES.width,i=j.get(),-1!=i.X&&CANVASAPI.drawLineSegmentFromLastPoint({context:context,last:i,current:{X:f,Y:g},width:h}),k===a.CONSTANTS.ACTIONS.Xextends&&j.set(0,g),k===a.CONSTANTS.ACTIONS.Ydrops&&j.set(f,0),k===a.CONSTANTS.ACTIONS.godRays&&j.set(0,0)};void 0!==b.buttons&&(1===b.buttons?c():(j.set(-1,-1),k===a.CONSTANTS.ACTIONS.pivots&&j.set(f,g)))})},stop:function(a){var b=a.event||CONSTANTS.Events.mousemove,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function c(){return $('<input id="widthPivotedLinePattern" type="range" min="1" max="200" step="1" title="width for pivoted line pattern tool." />')}function d(b){c().attr("value",a.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.width=$(this).val()}).appendTo(e);e.appendTo($(b.containerSelectionCriterion))}var e=$("<div></div>").attr("id",b.id).addClass("menu-item"),f=function(){var b=function(a,b,c){var d=$('<label style="color: white;">'+c+' <input id="'+a+'" name="'+b+'" type="radio" value="'+c+'" /></label>');return d};e.append(b("option_pivot","tool-options",a.CONSTANTS.ACTIONS.pivots)),e.append(b("option_extends","tool-options",a.CONSTANTS.ACTIONS.Xextends)),e.append(b("option_drops","tool-options",a.CONSTANTS.ACTIONS.Ydrops)),e.append(b("option_god_rays","tool-options",a.CONSTANTS.ACTIONS.godRays))};d(b),f()},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"PivotedLinePatternContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Pivoted Line Pattern"})}),$(function(){"use strict";var a={CONSTANTS:{id:"PointWalkerTool",selectionId:"#PointWalkerTool","class":"main-tool",title:"Click to draw random point walker. Click again to disable."},VARIABLES:{steps:100},start:function(b){var c=b.event,d="#"+b.canvasId,e=null,f=null,g=null,h=0;$(d).on(c,function(b){for(e={event:b,relativeTo:$(d)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=0;h<a.VARIABLES.steps;h++)CANVASAPI.fillCirc(f,g,1),f+=Math.random()<.5?-1:1,g-=Math.random()<.5?-1:1})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b,c,d){return $('<input id="'+a+'" type="range" min="'+b+'" max="'+c+'" step="1" title="'+d+'" />')}function d(b){function d(b){var d=c("pointWalkerSptes","500",b.maxStepsAllowed,"Steps for random point walk generation.").attr("value",a.VARIABLES.steps).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){a.VARIABLES.steps=$(this).val()});return d}return $('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.stepLabel).append(d(b))}var e=$("<div></div>").attr("id",b.id).addClass("menu-item");e.append(d(b)),e.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){$("#"+a.id).remove()},getOptions:function(){return{tool:this,id:"PointWalkerContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxStepsAllowed:1e5,stepLabel:"Steps: "}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Point Walker"})}),$(function(){"use strict";var a={CONSTANTS:{id:"RectangleTool",selectionId:"#RectangleTool","class":"main-tool",title:"Click to draw rectangles. Click again to disable.",previewId:"previewRectangle"},VARIABLES:{length:20,breadth:10,xyPlaneRotationAngle:360},start:function(b){function c(b){$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"2"}).appendTo(".utilities").on("click",function(b){var c={event:b,relativeTo:$(d)},e=Actions.Mouse.getX(c),f=Actions.Mouse.getY(c),g=a.VARIABLES.length,h=a.VARIABLES.breadth;l=a.VARIABLES.xyPlaneRotationAngle*Math.PI/180,CANVASAPI.fillRotatedRectangle(e-g/2,f-h/2,g,h,l)}).on("mousemove",function(b){$(this).css("top",b.pageY-a.VARIABLES.breadth/2-window.scrollY).css("left",b.pageX-a.VARIABLES.length/2-window.scrollX).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",a.VARIABLES.breadth).css("width",a.VARIABLES.length),j=$(this).offset().left+a.VARIABLES.length/2,k=$(this).offset().top+a.VARIABLES.breadth/2,f=$(d).offset().left,g=$(d).offset().top,(f>j||j>f+i||g>k||k>g+h)&&$(this).hide()})}var d=(b.event,"#"+b.canvasId),e=null,f=$(d).offset().left,g=$(d).offset().top,h=$(d).height(),i=$(d).width(),j=null,k=null,l=null;c(),$(d).on("mousemove",function(b){e=e||$("#"+a.CONSTANTS.previewId),e.css("top",b.pageY-a.VARIABLES.breadth/2-window.scrollY).css("left",b.pageX-a.VARIABLES.length/2-window.scrollX).css("background-color",selectedPrimaryColor).css("height",a.VARIABLES.breadth).css("width",a.VARIABLES.length).css("transform","rotate("+parseInt(a.VARIABLES.xyPlaneRotationAngle*Math.PI)/180+"rad)").show()})},stop:function(b){var c=b.event||CONSTANTS.Events.mouseclick,d="#"+(b.canvasId||CONSTANTS.canvasId);$(d).off(c),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(a,b,c){return $('<input id="'+a+'" type="range" min="1" max="'+c+'" step="1" title="'+b+'" />')}function d(b){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360).attr("value",a.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){a.VARIABLES.xyPlaneRotationAngle=$(this).val()})}function e(b){c(b.lengthId,b.lengthTitle,400).attr("value",a.VARIABLES.length).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.length=$(this).val()}).appendTo(f),c(b.breadthId,b.breadthTitle,400).attr("value",a.VARIABLES.breadth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.breadth=$(this).val()}).appendTo(f)}var f=$("<div></div>").attr("id",b.id).addClass("menu-item");e(b),f.append(d(b)),f.appendTo($(b.containerSelectionCriterion))},deactivate:function(b){function c(a){$("#"+a.lengthId).remove(),$("#"+a.breadthId).remove(),$("#xyPlaneRotationAngle").remove()}c(b),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"RectangleContextMenu",lengthId:"lengthRectangle",breadthId:"breadthRectangle",lengthTitle:"length for rectangle",breadthTitle:"breadth for rectangle",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Rectangle"})}),$(function(){"use strict";var a={CONSTANTS:{id:"RingTool",selectionId:"#RingTool","class":"main-tool",title:"Click to draw ring. Click again to disable.",previewId:"previewRing",previewOuterId:"previewOuterRing"},VARIABLES:{innerRadius:10,outerRadius:20},start:function(b){function c(b){var c=$("<div></div>").attr("id",a.CONSTANTS.previewOuterId).css({position:"fixed","z-index":"2","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"backgruond-color":selectedPrimaryColor}).appendTo(".utilities");$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(c).on("click",function(b){e={event:b,relativeTo:$(d)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.innerRadius,i=a.VARIABLES.outerRadius,CANVASAPI.fillRing({X:f,Y:g,innerRadius:h,outerRadius:i,strokeColor:selectedPrimaryColor,fillColor:selectedAlternativeColor})}).on("mousemove",function(b){$(this).css("top",b.pageY-parseInt(a.VARIABLES.innerRadius)-parseInt(window.scrollY)).css("left",b.pageX-parseInt(a.VARIABLES.innerRadius)-parseInt(window.scrollX)).css("background-color",selectedAlternativeColor).css("border","thin dashed "+selectedPrimaryColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius),q.css({position:"fixed",top:b.pageY-parseInt(a.VARIABLES.outerRadius)-parseInt(window.scrollY),left:b.pageX-parseInt(a.VARIABLES.outerRadius)-parseInt(window.scrollX),"z-index":"2","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}),o=$(this).offset().left+parseInt(a.VARIABLES.innerRadius),p=$(this).offset().top+parseInt(a.VARIABLES.innerRadius),k=$(d).offset().left,l=$(d).offset().top,(k>o||parseInt(k)+parseInt(n)<o||l>p||parseInt(l)+parseInt(m)<p)&&($(this).hide(),q.hide())})}var d=(b.event||CONSTANTS.Events.mouseclick,"#"+(b.canvasId||CONSTANTS.canvasId)),e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=$(d).height(),n=$(d).width(),o=null,p=null,q=null;c(),$(d).on("mousemove",function(b){j=j||$("#"+a.CONSTANTS.previewId),j.css("top",b.pageY-parseInt(a.VARIABLES.innerRadius)-parseInt(window.scrollY)).css("left",b.pageX-parseInt(a.VARIABLES.innerRadius)-parseInt(window.scrollX)).css("background-color",selectedAlternativeColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius).show(),q=q||$("#"+a.CONSTANTS.previewOuterId),q.css({position:"fixed",top:b.pageY-parseInt(a.VARIABLES.outerRadius)-parseInt(window.scrollY),left:b.pageX-parseInt(a.VARIABLES.outerRadius)-parseInt(window.scrollX),"z-index":"2","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}).show()})},stop:function(b){var c=b.event||CONSTANTS.Events.mouseclick,d="#"+(b.canvasId||CONSTANTS.canvasId);$(d).off(c),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove(),$("#"+a.CONSTANTS.previewOuterId).remove()},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c("innerRadiusRing","inner radius for ring tool.").attr("value",a.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.innerRadius=$(this).val()}).appendTo(d),c("outerRadiusRing","outer radius for ring tool.").attr("value",a.VARIABLES.outerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.outerRadius=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"RingContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Ring"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedCircleTool",selectionId:"#SpeedCircleTool","class":"main-tool",title:"Click to draw Circles. Click again to disable."},VARIABLES:{radius:4},start:function(b){var c=b.event,d="#"+b.canvasId,e=null,f=null,g=null,h=null;$(d).on(c,function(b){e={event:b,relativeTo:$(this)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.radius,CANVASAPI.drawCircle({X:f,Y:g,innerRadius:h,outerRadius:parseInt(h)+1,strokeColor:selectedPrimaryColor})})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(){return $('<input id="radiusSpeedCircle" type="range" min="1" max="200" step="1" title="radius for speed circle tool" />')}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",e.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){e.radius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}var e=a.VARIABLES;d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedCircleContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed circle"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedDiscTool",selectionId:"#SpeedDiscTool","class":"main-tool",title:"Click to draw Discs. Click again to disable."},VARIABLES:{radius:4},start:function(b){var c=b.event,d="#"+b.canvasId,e=null,f=null,g=null,h=null;$(d).on(c,function(b){e={event:b,relativeTo:$(this)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.radius,CANVASAPI.fillCirc(f,g,h)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(){return $('<input id="radiusSpeedDisc" type="range" min="1" max="200" step="1" title="radius for speed disc tool" />')}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",e.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){e.radius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}var e=a.VARIABLES;d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedDiscContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed disc"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedDotTool",selectionId:"#SpeedDotTool","class":"main-tool",title:"Click to draw dots. Click again to disable."},VARIABLES:{},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),CANVASAPI.fillCirc(e,f,1)})},stop:function(a){$("#"+a.canvasId).off(a.event)},Events:{register:function(b){var c=b.toolId,d=$(c);setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b)},function(){deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed dot"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedPencilTool",selectionId:"#SpeedPencilTool","class":"main-tool",title:"Click to draw draw free hand lines. Click again to disable."},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(b){function c(a){var b=a.context,c=a.last,d=a.current,e=a.width;b.beginPath(),b.moveTo(c.X,c.Y),b.lineTo(d.X,d.Y),b.lineWidth=e,b.strokeStyle=selectedPrimaryColor,b.stroke()}var d=b.event,e="#"+b.canvasId,f=null,g=null,h=null,i=null,j=null,k={get:function(){return{X:a.VARIABLES.LastPoint.X,Y:a.VARIABLES.LastPoint.Y}},set:function(b,c){a.VARIABLES.LastPoint.X=b,a.VARIABLES.LastPoint.Y=c}};$(e).on(d,function(b){f={event:b,relativeTo:$(this)},g=Actions.Mouse.getX(f),h=Actions.Mouse.getY(f),i=a.VARIABLES.width,j=k.get(),-1!=j.X&&c({context:context,last:j,current:{X:g,Y:h},width:i}),CANVASAPI.fillCirc(g,h,i/2),k.set(g,h)})},stop:function(b){a.VARIABLES.LastPoint.X=-1,a.VARIABLES.LastPoint.Y=-1,$("#"+b.canvasId).off(b.event)},ContextMenu:{activate:function(b){function c(){return $('<input id="widthSpeedPencil" type="range" min="1" max="200" step="1" title="width for speed pencil tool." />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c().attr("value",a.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.width=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedPencilContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed pencil"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedRectangleTool",selectionId:"#SpeedRectangleTool","class":"main-tool",title:"Click to draw speed rectangles. Click again to disable."},VARIABLES:{length:20,breadth:10},start:function(b){var c=(b.event,"#"+b.canvasId);$(c).on("mousemove",function(b){var d={event:b,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=a.VARIABLES.length,h=a.VARIABLES.breadth;context.fillRect(e-g/2,f-h/2,g,h)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c(b.lengthId,b.lengthTitle).attr("value",a.VARIABLES.length).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.length=$(this).val()}).appendTo(d),c(b.breadthId,b.breadthTitle).attr("value",a.VARIABLES.breadth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.breadth=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(b){function c(a){$("#"+a.lengthId).remove(),$("#"+a.breadthId).remove()}c(b),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"SpeedRectangleContextMenu",lengthId:"lengthSpeedRectangle",breadthId:"breadthSpeedRectangle",lengthTitle:"length for speed rectangle",breadthTitle:"breadth for speed rectangle",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed rectangle"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedRingTool",selectionId:"#SpeedRingTool","class":"main-tool",title:"Click to draw speed rings. Click again to disable."},VARIABLES:{innerRadius:10,outerRadius:20},start:function(b){var c=b.event,d="#"+b.canvasId,e=null,f=null,g=null,h=null,i=null;$(d).on(c,function(b){e={event:b,relativeTo:$(this)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.innerRadius,i=a.VARIABLES.outerRadius,CANVASAPI.fillRing({X:f,Y:g,innerRadius:h,outerRadius:i,strokeColor:selectedPrimaryColor,fillColor:selectedAlternativeColor})})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c("innerRadiusSpeedRing","inner radius for speed ring tool.").attr("value",a.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.innerRadius=$(this).val()}).appendTo(d),c("outerRadiusSpeedRing","outer radius for speed ring tool.").attr("value",a.VARIABLES.outerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.outerRadius=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedRingContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed ring"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SpeedSquareTool",selectionId:"#SpeedSquareTool","class":"main-tool",title:"Click to draw speed squares. Click again to disable."
},VARIABLES:{side:10,xyPlaneRotationAngle:360},start:function(b){var c=(b.event,"#"+b.canvasId);$(c).on("mousemove",function(b){var d={event:b,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=a.VARIABLES.side,h=a.VARIABLES.xyPlaneRotationAngle*Math.PI/180;CANVASAPI.fillRoatedSquare(e-g/2,f-g/2,g,h)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b,c){return $('<input id="'+a+'" type="range" min="1" max="'+c+'" step="1" title="'+b+'" />')}function d(a){var b=$("#"+a.id);return 0===b.length?$("<div></div>").attr("id",a.id).addClass("menu-item"):b}function e(b){function d(b){return c("sideSpeedSquare","side length for square tool",200).attr("value",a.VARIABLES.side).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.side=$(this).val()})}return $('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.sideLabel).append(d(b))}function f(b){function d(b){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360).attr("value",a.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){a.VARIABLES.xyPlaneRotationAngle=$(this).val()})}return $('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.xyPlaneRotationAngle).append(d(b))}var g=d(b);e(b).appendTo(g),f(b).appendTo(g),g.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedSquareToolContextMenu",containerSelectionCriterion:".contextual-tool-bar",xyPlaneRotationAngle:"xy plane rotation angle: ",sideLabel:"side length: "}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed square"})}),$(function(){"use strict";var a={CONSTANTS:{id:"SquareTool",selectionId:"#SquareTool","class":"main-tool",title:"Click to draw squares. Click again to disable.",previewId:"previewSquare"},VARIABLES:{side:10,xyPlaneRotationAngle:360},start:function(b){function c(b){$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"2"}).appendTo(".utilities").on("click",function(b){var c={event:b,relativeTo:$(d)},e=Actions.Mouse.getX(c),f=Actions.Mouse.getY(c),g=a.VARIABLES.side,h=a.VARIABLES.xyPlaneRotationAngle*Math.PI/180;CANVASAPI.fillRoatedSquare(e-g/2,f-g/2,g,h)}).on("mousemove",function(b){$(this).css("top",parseInt(b.pageY)-parseInt(a.VARIABLES.side/2)-parseInt(window.scrollY)).css("left",parseInt(b.pageX)-parseInt(parseInt(a.VARIABLES.side/2))-parseInt(window.scrollX)).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",a.VARIABLES.side).css("width",a.VARIABLES.side),j=parseInt($(this).offset().left)+parseInt(a.VARIABLES.side/2),k=parseInt($(this).offset().top)+parseInt(a.VARIABLES.side/2),f=$(d).offset().left,g=$(d).offset().top,(f>j||parseInt(f+i)<j||g>k||parseInt(g+h)<k)&&$(this).hide()})}var d=(b.event||CONSTANTS.Events.mouseclick,"#"+(b.canvasId||CONSTANTS.canvasId)),e=null,f=$(d).offset().left,g=$(d).offset().top,h=$(d).height(),i=$(d).width(),j=null,k=null;c(),$(d).on("mousemove",function(b){e=e||$("#"+a.CONSTANTS.previewId),e.css("top",b.pageY-parseInt(a.VARIABLES.side/2)-window.scrollY).css("left",b.pageX-parseInt(a.VARIABLES.side/2)-window.scrollX).css("background-color",selectedPrimaryColor).css("height",a.VARIABLES.side).css("width",a.VARIABLES.side).css("transform","rotate("+parseInt(a.VARIABLES.xyPlaneRotationAngle*Math.PI)/180+"rad)").show()})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function c(a,b,c){return $('<input id="'+a+'" type="range" min="1" max="'+c+'" step="1" title="'+b+'" />')}function d(a){var b=$("#"+a.id);return 0===b.length?$("<div></div>").attr("id",a.id).addClass("menu-item"):b}function e(b){return c("sideSquare","side length for square tool",200).attr("value",a.VARIABLES.side).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.side=$(this).val()})}function f(b){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360).attr("value",a.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){a.VARIABLES.xyPlaneRotationAngle=$(this).val()})}var g=d(b);e(b).appendTo(g),f(b).appendTo(g),g.appendTo($(b.containerSelectionCriterion))},deactivate:function(b){function c(a){$("#"+a.id).remove()}c(b),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"SquareToolContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Square"})}),$(function(){"use strict";var a={CONSTANTS:{id:"CircleTool",selectionId:"#CircleTool","class":"main-tool",title:"Click to draw circle. Click again to disable.",previewId:"previewCircle"},VARIABLES:{innerRadius:10},start:function(b){function c(b){$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(".utilities").on("click",function(b){e={event:b,relativeTo:$(d)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.innerRadius,i=parseInt(a.VARIABLES.innerRadius)+1,CANVASAPI.drawCircle({X:f,Y:g,innerRadius:h,outerRadius:i,strokeColor:selectedPrimaryColor})}).on("mousemove",function(b){$(this).css("top",b.pageY-a.VARIABLES.innerRadius-window.scrollY).css("left",b.pageX-a.VARIABLES.innerRadius-window.scrollX).css("border","thin solid "+selectedPrimaryColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius),o=parseInt($(this).offset().left)+parseInt(a.VARIABLES.innerRadius),p=parseInt($(this).offset().top)+parseInt(a.VARIABLES.innerRadius),k=$(d).offset().left,l=$(d).offset().top,(k>o||parseInt(k)+parseInt(n)<o||l>p||parseInt(l)+parseInt(m)<p)&&$(this).hide()})}var d=(b.event||CONSTANTS.Events.mouseclick,"#"+(b.canvasId||CONSTANTS.canvasId)),e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=$(d).height(),n=$(d).width(),o=null,p=null;c(),$(d).on("mousemove",function(b){j=j||$("#"+a.CONSTANTS.previewId),j.css("top",b.pageY-a.VARIABLES.innerRadius-window.scrollY).css("left",b.pageX-a.VARIABLES.innerRadius-window.scrollX).css("border","thin solid "+selectedPrimaryColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius).show()})},stop:function(b){var c=b.event||CONSTANTS.Events.mouseclick,d="#"+(b.canvasId||CONSTANTS.canvasId);$(d).off(c),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item"),e=c("radiusCircle","innerRadius for circle tool.").attr("value",a.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.innerRadius=$(this).val()});e.appendTo(d),d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"CircleContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Circle"})}),$(function(){"use strict";var a={CONSTANTS:{id:"DiscTool",selectionId:"#DiscTool","class":"main-tool",title:"Click to draw disc. Click again to disable.",previewId:"previewDisc"},VARIABLES:{radius:10},start:function(b){function c(b){$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(".utilities").on("click",function(b){e={event:b,relativeTo:$(d)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.radius,CANVASAPI.fillCirc(f,g,h)}).on("mousemove",function(b){$(this).css("top",b.pageY-a.VARIABLES.radius-window.scrollY).css("left",b.pageX-a.VARIABLES.radius-window.scrollX).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",2*a.VARIABLES.radius).css("width",2*a.VARIABLES.radius),n=parseInt($(this).offset().left)+parseInt(a.VARIABLES.radius),o=parseInt($(this).offset().top)+parseInt(a.VARIABLES.radius),j=$(d).offset().left,k=$(d).offset().top,(j>n||parseInt(j)+parseInt(m)<n||k>o||parseInt(k)+parseInt(l)<o)&&$(this).hide()})}var d=(b.event||CONSTANTS.Events.mouseclick,"#"+(b.canvasId||CONSTANTS.canvasId)),e=null,f=null,g=null,h=null,i=null,j=$(d).offset().left,k=$(d).offset().top,l=$(d).height(),m=$(d).width(),n=null,o=null;c(),$(d).on("mousemove",function(b){i=i||$("#"+a.CONSTANTS.previewId),i.css("top",b.pageY-a.VARIABLES.radius-window.scrollY).css("left",b.pageX-a.VARIABLES.radius-window.scrollX).css("background-color",selectedPrimaryColor).css("height",2*a.VARIABLES.radius).css("width",2*a.VARIABLES.radius).show()})},stop:function(b){var c=b.event||CONSTANTS.Events.mouseclick,d="#"+(b.canvasId||CONSTANTS.canvasId);$(d).off(c),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(){return $('<input id="radiusDisc" type="range" min="1" max="200" step="1" title="radius for disc tool." />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c().attr("value",a.VARIABLES.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.radius=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"DiscContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Disc"})});