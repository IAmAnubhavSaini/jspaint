/*! jspaint 2015-07-11 Anubhav Saini (c) 2015 */
!function(a){"use strict";a(function(){var b=function(b){var c=a("<canvas/>",{id:b.canvasId}).prop({width:b.width,height:b.height}).appendTo("#"+b.canvasContainerId);return c[0]},c=function(a){var c=a.sizeX||600,d=a.sizeY||400,e=c-2,f=d-2,g=null;return a.width=e,a.height=f,g=b(a),g.getContext("2d")},d=function(a){return"#"+a.attr("id").split("#")[1]},e=function(){a(".color").attr("title","Left click for primary color, Right click for alternative color.").attr("data-toggle","tooltip").attr("data-placement","bottom").on("click",function(){selectedPrimaryColor=context.fillStyle=d(a(this)),a("#SelectedPrimaryColor").css("background-color",selectedPrimaryColor)}).on("contextmenu",function(b){b.preventDefault(),selectedAlternativeColor=d(a(this)),a("#SelectedAlternativeColor").css("background-color",selectedAlternativeColor)})},f=function(b){a("#"+b.containerId+" #"+b.toolId).on("input",function(){selectedPrimaryColor=context.fillStyle=a(this).val()})},g=function(b){a("#"+b.toolId).on("click",function(){window.open(a("#"+CONSTANTS.canvasId)[0].toDataURL("image/png"),"_blank")})},h=function(b){a("#"+b.toolId).on("click",function(){var c="#"+(b.canvasId||CONSTANTS.canvasId),d=a(c)[0],e=d.height,f=d.width,g=d.getContext("2d");g.clearRect(0,0,f,e)})},i=function(){e(),f({toolId:"allColorsPicker",containerId:"HTML5ColorPicker"}),g({toolId:"save-as-image",containerId:"SaveImageButton"}),h({toolId:"reset-canvas",containerId:"ResetCanvas"})},j=function(){sizeX>2500?sizeX=2500:sizeX<320&&(sizeX=320),sizeY>2500?sizeY=2500:sizeY<320&&(sizeY=320),a("#jspaint-paint-area").css({width:sizeX,height:sizeY})},k=function(){a(".top-taker").TopTaker({theme:"dark"})},l=function(){j(),context=c({sizeX:sizeX,sizeY:sizeY,canvasId:CONSTANTS.canvasId,canvasContainerId:CONSTANTS.canvasContainerId}),k(),Color.generateBasicColorPalette({appendHere:".BasicColorPalette",basicColors:CONSTANTS.basicColors}),i(),a("#PencilTool").trigger("click"),a('[data-toggle="tooltip"]').tooltip(),a("#SelectedPrimaryColor").css("background-color",selectedPrimaryColor),a("#SelectedAlternativeColor").css("background-color",selectedAlternativeColor),a("#MenuButton").on("click",function(){a("#Menu").toggle(),a(this).toggleClass("active-menu")})};l()})}(jQuery);