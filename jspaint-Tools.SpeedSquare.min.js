/*! jspaint 2015-07-14 Anubhav Saini (c) 2015 */
$(function(){"use strict";var a={CONSTANTS:{id:"SpeedSquareTool",selectionId:"#SpeedSquareTool","class":"main-tool",title:"Click to draw speed squares. Click again to disable."},VARIABLES:{side:10,xyPlaneRotationAngle:360},start:function(b){var c=(b.event,"#"+b.canvasId);$(c).on("mousemove",function(b){var d={event:b,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=a.VARIABLES.side,h=a.VARIABLES.xyPlaneRotationAngle*Math.PI/180;CANVASAPI.fillRoatedSquare(e-g/2,f-g/2,g,h)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(a,b,c){return $('<input id="'+a+'" type="range" min="1" max="'+c+'" step="1" title="'+b+'" />')}function d(a){var b=$("#"+a.id);return 0===b.length?$("<div></div>").attr("id",a.id).addClass("menu-item"):b}function e(b){function d(b){return c("sideSpeedSquare","side length for square tool",200).attr("value",a.VARIABLES.side).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.side=$(this).val()})}return $('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.sideLabel).append(d(b))}function f(b){function d(b){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360).attr("value",a.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){a.VARIABLES.xyPlaneRotationAngle=$(this).val()})}return $('<label style="color: #FFFFFF; font-size: 10px;"></label>').append(b.xyPlaneRotationAngle).append(d(b))}var g=d(b);e(b).appendTo(g),f(b).appendTo(g),g.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedSquareToolContextMenu",containerSelectionCriterion:".contextual-tool-bar",xyPlaneRotationAngle:"xy plane rotation angle: ",sideLabel:"side length: "}}},Events:{register:function(b){var c=b.toolId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(b)})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop,toolName:"Speed square"})});