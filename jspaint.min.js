/*! jspaint 2015-09-01 Anubhav Saini (c) 2015 */
!function(a){"use strict";a(function(){var b=function(b){var c=a("<canvas/>",{id:b.canvasId}).prop({width:b.width,height:b.height}).appendTo("#"+b.canvasContainerId);return c[0]},c=function(a){var c=a.sizeX||600,d=a.sizeY||400,e=c-2,f=d-2,g=null;return a.width=e,a.height=f,g=b(a),g.getContext("2d")},d=function(a){return"#"+a.attr("id").split("#")[1]},e=function(){function b(b){a("label#primary-color-name").css("color",b).html(b)}function c(b){a("label#alternative-color-name").css("color",b).html(b)}a(".color").attr("title","Left click for primary color, Right click for alternative color.").attr("data-toggle","tooltip").attr("data-placement","bottom").on("click",function(){selectedPrimaryColor=context.fillStyle=d(a(this)),a("#SelectedPrimaryColor").css("background-color",selectedPrimaryColor),b(selectedPrimaryColor)}).on("contextmenu",function(b){b.preventDefault(),selectedAlternativeColor=d(a(this)),a("#SelectedAlternativeColor").css("background-color",selectedAlternativeColor),c(selectedAlternativeColor)}),b(selectedPrimaryColor),c(selectedAlternativeColor)},f=function(b){a("#"+b.toolId).on("input",function(){selectedPrimaryColor=context.fillStyle=a(this).val()})},g=function(b){a("#"+b.toolId).on("click",function(){window.open(a("#"+CONSTANTS.canvasId)[0].toDataURL("image/png"),"_blank")})},h=function(b){a("#"+b.toolId).on("click",function(){var c="#"+(b.canvasId||CONSTANTS.canvasId),d=a(c)[0],e=d.height,f=d.width,g=d.getContext("2d");g.clearRect(0,0,f,e),CanvasState=[]})},i=function(b){a(b.toolSelection).on("click",function(){var a=CanvasState.pop();void 0!==a&&context.putImageData(a,0,0)}),a(b.canvasId).on("mousedown",function(){CanvasState.push(context.getImageData(0,0,a(this).width(),a(this).height()))})},j=function(){e(),f({toolId:"allColorsPicker",containerId:"HTML5ColorPicker"}),g({toolId:"save-as-image",containerId:"SaveImageButton"}),h({toolId:"reset-canvas",containerId:"ResetCanvas"}),i({toolSelection:"#undo-button",canvasId:"#"+CONSTANTS.canvasId})},k=function(){sizeX>2500?sizeX=2500:sizeX<320&&(sizeX=320),sizeY>2500?sizeY=2500:sizeY<320&&(sizeY=320),a("#jspaint-paint-area").css({width:sizeX,height:sizeY})},l=function(){a(".top-taker").TopTaker({theme:"dark"})},m=function(){k(),context=c({sizeX:sizeX,sizeY:sizeY,canvasId:CONSTANTS.canvasId,canvasContainerId:CONSTANTS.canvasContainerId}),l(),Color.generateBasicColorPalette({appendHere:".BasicColorPalette",basicColors:CONSTANTS.basicColors}),j(),a("#PencilTool").trigger("click"),a('[data-toggle="tooltip"]').tooltip(),a("#SelectedPrimaryColor").css("background-color",selectedPrimaryColor),a("#SelectedAlternativeColor").css("background-color",selectedAlternativeColor)};m()})}(jQuery);