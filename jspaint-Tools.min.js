/*! jspaint 2015-09-29 Anubhav Saini (c) 2015 */
$(function(){"use strict";var a={generateSlider:function(a){var b=a.min,c=a.max,d=a.title,e=a.id,f=a.step;return $('<input id="'+e+'" type="range" min="'+b+'" max="'+c+'" step="'+f+'" title="'+d+'" />')},generateLabel:function(a){var b=a.hexColor,c=a.fontSize;return $('<label style="color: #'+b+"; font-size: "+c+';"></label>')},genericLabel:function(){return a.generateLabel({hexColor:"FFFFFF",fontSize:"10px"})},registerEventForTool:function(a){var b=a.toolId,c=$(b),d=a.contextMenu,e=a.constantTitle;setupToolTips(c,e),a.tool=c,c.funcToggle("click",function(){activateTool(a),d.activate(d.getOptions())},function(){d.deactivate(d.getOptions()),deactivateTool(a)})}};$("#image-button").on("change",function(a){var b=new FileReader;b.onload=function(a){var b=new Image;b.onload=function(){context.drawImage(b,0,0)},b.src=a.target.result},b.readAsDataURL(a.target.files[0])});var b={CONSTANTS:{id:"MandelbrotFractalTool",selectionId:"#MandelbrotFractalTool","class":"main-tool",title:"Click to draw Mandelbrot Fractal. Click again to disable.",maxHeight:-1,maxWidth:-1},VARIABLES:{iterations:1e3,xMax:1,yMax:1,xMin:-2,yMin:-1,height:-1,width:-1},start:function(a){function c(a){function c(a,b,c){for(var d=0,e=0,f=0,g=0,h=0,i=c;i--&&4>=f+g;)h=d*e,f=d*d,g=e*e,d=f-g+a,e=h+h+b;return c-i}function d(a){var d,e,f,g,h,i,j,k=a.context,l=a.XMin,m=a.YMin,n=a.XMax,o=a.YMax,p=a.iterations,q=b.VARIABLES.width,r=b.VARIABLES.height,s=k.getImageData(0,0,q,r),t=s.data,u=Color.hexToRgb(selectedPrimaryColor);for(d=0;q>d;++d)for(e=0;r>e;++e)f=l+(n-l)*d/(q-1),g=m+(o-m)*e/(r-1),h=c(f,g,p),j=4*(q*e+d),h>p?(t[j]=u.r,t[j+1]=u.g,t[j+2]=u.b):(i=3*Math.log(h)/Math.log(p-1),1>i?(t[j]=255*i,t[j+1]=0,t[j+2]=0):2>i?(t[j]=255,t[j+1]=255*(i-1),t[j+2]=0):(t[j]=255,t[j+1]=255,t[j+2]=255*(i-2))),t[j+3]=255;k.putImageData(s,a.startX,a.startY)}d(a)}var d=a.event,e=a.canvasId,f=function(a){return a+Math.floor(b.VARIABLES.width)-b.CONSTANTS.maxWidth},g=function(a){var c=Actions.Mouse.getX(a),d=Math.max(c-Math.floor(b.VARIABLES.width/2),0),e=f(d);return e>0&&(d-=e),d},h=function(a){return a+Math.floor(b.VARIABLES.height)-b.CONSTANTS.maxHeight},i=function(a){var c=Actions.Mouse.getY(a),d=Math.max(c-Math.floor(b.VARIABLES.height/2),0),e=h(d);return e>0&&(d-=e),d};$(e).on(d,function(a){var d={event:a,relativeTo:$(e)},f=g(d),h=i(d);c({context:context,XMin:b.VARIABLES.xMin,XMax:b.VARIABLES.xMax,YMin:b.VARIABLES.yMin,YMax:b.VARIABLES.yMax,iterations:b.VARIABLES.iterations,startX:f,startY:h})})},stop:function(a){$(a.canvasId).off(a.event)},ContextMenu:{activate:function(c){function d(b,c,d,e){return a.generateSlider({id:b,min:c,max:d,step:1,title:e})}function e(c){function e(a){var c=d("mandelbrotIterations","10",a.maxIterationsAllowed,"Iterations for mandelbrot fractal generation. Beware! If higher values are used, it might crash your browser.").attr("value",b.VARIABLES.iterations).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var c=$(this).val();c>a.maxIterationsAllowed&&confirm("Beware! It might crash your browser. Go back?","back","No, I want these many iterations. I know what I am doing!")&&(c=a.maxIterationsAllowed),b.VARIABLES.iterations=c});return c}var f=a.genericLabel().append(c.iterationLabel).append(e(c));return f}function f(c){function e(a){var c=d("mandelbrotHeight","100",b.CONSTANTS.maxHeight,"Height for mandelbrot fractal generation.").attr("value",b.CONSTANTS.maxHeight).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var a=$(this).val();a>b.CONSTANTS.maxHeight&&(a=b.CONSTANTS.maxHeight),b.VARIABLES.height=a});return c}var f=a.genericLabel().append(c.heightLabel).append(e(c));return f}function g(c){function e(a){var c=d("mandelbrotWidth","100",b.CONSTANTS.maxWidth,"Width for mandelbrot fractal generation.").attr("value",b.CONSTANTS.maxWidth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){var a=$(this).val();a>b.CONSTANTS.maxWidth&&(a=b.CONSTANTS.maxWidth),b.VARIABLES.width=a});return c}var f=a.genericLabel().append(c.widthLabel).append(e(c));return f}function h(c){function e(a){var c=d("mandelbrotXMax","0","3","XMax for mandelbrot fractal generation.").attr("value","1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){b.VARIABLES.xMax=$(this).val()});return c}var f=a.genericLabel().append(c.xMaxLabel).append(e(c));return f}function i(c){function e(a){var c=d("mandelbrotYMax","0","3","YMax for mandelbrot fractal generation.").attr("value","1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){b.VARIABLES.yMax=$(this).val()});return c}var f=a.genericLabel().append(c.yMaxLabel).append(e(c));return f}function j(c){function e(a){var c=d("mandelbrotXMin","-3","1","XMin for mandelbrot fractal generation.").attr("value","-2").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){b.VARIABLES.xMin=$(this).val()});return c}var f=a.genericLabel().append(c.xMinLabel).append(e(c));return f}function k(c){function e(a){var c=d("mandelbrotYMin","-2","1","YMin for mandelbrot fractal generation.").attr("value","-1").attr("disabled","disabled").on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){b.VARIABLES.yMin=$(this).val()});return c}var f=a.genericLabel().append(c.yMinLabel).append(e(c));return f}var l=$("<div></div>").attr("id",c.id).addClass("menu-item");l.append(e(c)),l.append(f(c)),l.append(g(c)),l.append(h(c)),l.append(i(c)),l.append(j(c)),l.append(k(c)),l.appendTo($(c.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"MandelbrotFractalContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxIterationsAllowed:2e3,minIterationsAllowed:10,iterationLabel:"Iterations: ",maxHeightAllowed:b.VARIABLES.maxHeight,heightLabel:"Height: ",maxWidthAllowed:b.VARIABLES.maxWidth,widthLabel:"Width: ",xMaxLabel:"XMax: ",yMaxLabel:"YMax: ",xMinLabel:"XMin: ",yMinLabel:"YMin: "}}},Events:{register:function(a){var c=a.toolId,d=$(c),e=b.ContextMenu;setupToolTips(d,b.CONSTANTS.title),a.tool=d,d.funcToggle("click",function(){activateTool(a),b.VARIABLES.height=b.CONSTANTS.maxHeight=$(a.canvasId)[0].height,b.VARIABLES.width=b.CONSTANTS.maxWidth=$(a.canvasId)[0].width,e.activate(e.getOptions())},function(){e.deactivate(e.getOptions()),deactivateTool(a)})}}};b.Events.register({toolId:b.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:"#"+CONSTANTS.canvasId,start:b.start,stop:b.stop,toolName:"Mandelbrot fractal"});var c={CONSTANTS:{id:"PencilTool",selectionId:"#PencilTool","class":"main-tool",title:"Click to draw free-hand lines. Click again to disable."},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(a){var b=a.event,d="#"+a.canvasId,e=null,f=null,g=null,h=null,i=null,j={get:function(){return{X:c.VARIABLES.LastPoint.X,Y:c.VARIABLES.LastPoint.Y}},set:function(a,b){c.VARIABLES.LastPoint.X=a,c.VARIABLES.LastPoint.Y=b}};$(d).on(b,function(a){e={event:a,relativeTo:$(this)};var b=function(){f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=c.VARIABLES.width,i=j.get(),-1!=i.X&&CANVASAPI.drawLineSegmentFromLastPoint({context:context,last:i,current:{X:f,Y:g},width:h}),j.set(f,g)};void 0!==a.buttons&&(1===a.buttons?b():(c.VARIABLES.LastPoint.X=-1,c.VARIABLES.LastPoint.Y=-1))})},stop:function(a){var b=a.event||CONSTANTS.Events.mousemove,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function d(){return a.generateSlider({id:"widthPencil",min:1,max:200,step:1,title:"Width for pencil tool."})}function e(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");d().attr("value",c.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){c.VARIABLES.width=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}e(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"PencilContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:c.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:c.start,stop:c.stop,toolName:"Pencil",contextMenu:c.ContextMenu,constantTitle:c.CONSTANTS.title});var d={CONSTANTS:{id:"pick-color",selectionId:"#pick-color","class":"string-menu-item",containerId:"PickColorTool",title:"Click to pick color under mouse pointer tip; picks until some other tool is selected. Click again to disable."},ContextMenu:{activate:function(){},deactivate:function(){},getOptions:function(){}},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null,g=null,h=0,i=0,j=0,k=0;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=context.getImageData(e-.5,f-.5,e+.5,f+.5).data,h=g[0],i=g[1],j=g[2],k=g[3],selectedPrimaryColor=context.fillStyle="rgba("+h+", "+i+", "+j+", "+k+")"})},stop:function(a){var b=a.event,c="#"+a.canvasId;$(c).off(b)}};a.registerEventForTool({toolId:d.CONSTANTS.selectionId,containerId:d.CONSTANTS.containerId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:d.start,stop:d.stop,toolName:"Color picker",contextMenu:d.ContextMenu,constantTitle:d.CONSTANTS.title});var e={CONSTANTS:{id:"PivotedLinePatternTool",selectionId:"#PivotedLinePatternTool","class":"main-tool",title:"Click to draw amazing pattern. Click again to disable.",ACTIONS:{pivots:"pivots",Ydrops:"drops",godRays:"god-rays",Xextends:"extends"}},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(a){var b=a.event||CONSTANTS.Events.mousemove,c="#"+(a.canvasId||CONSTANTS.canvasId),d=null,f=null,g=null,h=null,i=null,j={get:function(){return{X:e.VARIABLES.LastPoint.X,Y:e.VARIABLES.LastPoint.Y}},set:function(a,b){e.VARIABLES.LastPoint.X=a,e.VARIABLES.LastPoint.Y=b}},k=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},f=Actions.Mouse.getX(d),g=Actions.Mouse.getY(d),k=$("[name=tool-options]:checked").val();var b=function(){h=e.VARIABLES.width,i=j.get(),-1!=i.X&&CANVASAPI.drawLineSegmentFromLastPoint({context:context,last:i,current:{X:f,Y:g},width:h}),k===e.CONSTANTS.ACTIONS.Xextends&&j.set(0,g),k===e.CONSTANTS.ACTIONS.Ydrops&&j.set(f,0),k===e.CONSTANTS.ACTIONS.godRays&&j.set(0,0)};void 0!==a.buttons&&(1===a.buttons?b():(j.set(-1,-1),k===e.CONSTANTS.ACTIONS.pivots&&j.set(f,g)))})},stop:function(a){var b=a.event||CONSTANTS.Events.mousemove,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function c(){return a.generateSlider({id:"widthPivotedLinePattern",min:1,max:200,step:1,title:"width for pivoted line pattern tool."})}function d(a){c().attr("value",e.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){e.VARIABLES.width=$(this).val()}).appendTo(f);f.appendTo($(a.containerSelectionCriterion))}var f=$("<div></div>").attr("id",b.id).addClass("menu-item"),g=function(){var b=function(b,c,d){return a.genericLabel().append(d).append(' <input id="'+b+'" name="'+c+'" type="radio" value="'+d+'" /></label>')};f.append(b("option_pivot","tool-options",e.CONSTANTS.ACTIONS.pivots)),f.append(b("option_extends","tool-options",e.CONSTANTS.ACTIONS.Xextends)),f.append(b("option_drops","tool-options",e.CONSTANTS.ACTIONS.Ydrops)),f.append(b("option_god_rays","tool-options",e.CONSTANTS.ACTIONS.godRays))};d(b),g()},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"PivotedLinePatternContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:e.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:e.start,stop:e.stop,toolName:"Pivoted Line Pattern",contextMenu:e.ContextMenu,constantTitle:e.CONSTANTS.title});var f={CONSTANTS:{id:"PointWalkerTool",selectionId:"#PointWalkerTool","class":"main-tool",title:"Click to draw random point walker. Click again to disable."},VARIABLES:{steps:100},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,g=null,h=0;$(c).on(b,function(a){for(d={event:a,relativeTo:$(c)},e=Actions.Mouse.getX(d),g=Actions.Mouse.getY(d),h=0;h<f.VARIABLES.steps;h++)CANVASAPI.fillCirc(e,g,1),e+=Math.random()<.5?-1:1,g-=Math.random()<.5?-1:1})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c,d,e){return a.generateSlider({id:b,min:c,max:d,step:1,title:e})}function d(b){function d(a){var b=c("pointWalkerSptes","500",a.maxStepsAllowed,"Steps for random point walk generation.").attr("value",f.VARIABLES.steps).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){f.VARIABLES.steps=$(this).val()});return b}return a.genericLabel().append(b.stepLabel).append(d(b))}var e=$("<div></div>").attr("id",b.id).addClass("menu-item");e.append(d(b)),e.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){$("#"+a.id).remove()},getOptions:function(){return{tool:this,id:"PointWalkerContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxStepsAllowed:1e5,stepLabel:"Steps: "}}}};a.registerEventForTool({toolId:f.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:f.start,stop:f.stop,toolName:"Point Walker",contextMenu:f.ContextMenu,constantTitle:f.CONSTANTS.title});var g={CONSTANTS:{id:"RectangleTool",selectionId:"#RectangleTool","class":"main-tool",title:"Click to draw rectangles. Click again to disable.",previewId:"previewRectangle"},VARIABLES:{length:20,breadth:10,xyPlaneRotationAngle:360},start:function(a){function b(a){$("<div></div>").attr("id",g.CONSTANTS.previewId).css({position:"fixed","z-index":"2"}).appendTo(".utilities").on("click",function(a){var b={event:a,relativeTo:$(c)},d=Actions.Mouse.getX(b),e=Actions.Mouse.getY(b),f=g.VARIABLES.length,h=g.VARIABLES.breadth;l=g.VARIABLES.xyPlaneRotationAngle*Math.PI/180,CANVASAPI.fillRotatedRectangle(d-f/2,e-h/2,f,h,l)}).on("mousemove",function(a){$(this).css("top",a.pageY-g.VARIABLES.breadth/2-window.scrollY).css("left",a.pageX-g.VARIABLES.length/2-window.scrollX).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",g.VARIABLES.breadth).css("width",g.VARIABLES.length),j=$(this).offset().left+g.VARIABLES.length/2,k=$(this).offset().top+g.VARIABLES.breadth/2,e=$(c).offset().left,f=$(c).offset().top,(e>j||j>e+i||f>k||k>f+h)&&$(this).hide()})}var c=(a.event,"#"+a.canvasId),d=null,e=$(c).offset().left,f=$(c).offset().top,h=$(c).height(),i=$(c).width(),j=null,k=null,l=null;b(),$(c).on("mousemove",function(a){d=d||$("#"+g.CONSTANTS.previewId),d.css("top",a.pageY-g.VARIABLES.breadth/2-window.scrollY).css("left",a.pageX-g.VARIABLES.length/2-window.scrollX).css("background-color",selectedPrimaryColor).css("height",g.VARIABLES.breadth).css("width",g.VARIABLES.length).css("transform","rotate("+parseInt(g.VARIABLES.xyPlaneRotationAngle*Math.PI)/180+"rad)").show()})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b),$("#"+g.CONSTANTS.previewId).off("mousemove"),$("#"+g.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(b,c,d,e){return a.generateSlider({id:b,min:e,max:d,step:1,title:c})}function d(a){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360,0).attr("value",g.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){g.VARIABLES.xyPlaneRotationAngle=$(this).val()})}function e(a){c(a.lengthId,a.lengthTitle,400,10).attr("value",g.VARIABLES.length).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){g.VARIABLES.length=$(this).val()}).appendTo(f),c(a.breadthId,a.breadthTitle,400,10).attr("value",g.VARIABLES.breadth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){g.VARIABLES.breadth=$(this).val()}).appendTo(f)}var f=$("<div></div>").attr("id",b.id).addClass("menu-item");e(b),f.append(d(b)),f.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.lengthId).remove(),$("#"+a.breadthId).remove(),$("#xyPlaneRotationAngle").remove()}b(a),$("#"+g.CONSTANTS.previewId).off("mousemove"),$("#"+g.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"RectangleContextMenu",lengthId:"lengthRectangle",breadthId:"breadthRectangle",lengthTitle:"length for rectangle",breadthTitle:"breadth for rectangle",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:g.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:g.start,stop:g.stop,toolName:"Rectangle",contextMenu:g.ContextMenu,constantTitle:g.CONSTANTS.title});var h={CONSTANTS:{id:"RingTool",selectionId:"#RingTool","class":"main-tool",title:"Click to draw ring. Click again to disable.",previewId:"previewRing",previewOuterId:"previewOuterRing"},VARIABLES:{innerRadius:10,outerRadius:20},start:function(a){function b(a){var b=$("<div></div>").attr("id",h.CONSTANTS.previewOuterId).css({position:"fixed","z-index":"2","border-radius":"50%",height:2*h.VARIABLES.outerRadius,width:2*h.VARIABLES.outerRadius,"backgruond-color":selectedPrimaryColor}).appendTo(".utilities");$("<div></div>").attr("id",h.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(b).on("click",function(a){d={event:a,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=h.VARIABLES.innerRadius,i=h.VARIABLES.outerRadius,CANVASAPI.fillRing({X:e,Y:f,innerRadius:g,outerRadius:i,strokeColor:selectedPrimaryColor,fillColor:selectedAlternativeColor})}).on("mousemove",function(a){$(this).css("top",a.pageY-parseInt(h.VARIABLES.innerRadius)-parseInt(window.scrollY)).css("left",a.pageX-parseInt(h.VARIABLES.innerRadius)-parseInt(window.scrollX)).css("background-color",selectedAlternativeColor).css("border","thin dashed "+selectedPrimaryColor).css("height",2*h.VARIABLES.innerRadius).css("width",2*h.VARIABLES.innerRadius),q.css({position:"fixed",top:a.pageY-parseInt(h.VARIABLES.outerRadius)-parseInt(window.scrollY),left:a.pageX-parseInt(h.VARIABLES.outerRadius)-parseInt(window.scrollX),"z-index":"2","border-radius":"50%",height:2*h.VARIABLES.outerRadius,width:2*h.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}),o=$(this).offset().left+parseInt(h.VARIABLES.innerRadius),p=$(this).offset().top+parseInt(h.VARIABLES.innerRadius),k=$(c).offset().left,l=$(c).offset().top,(k>o||parseInt(k)+parseInt(n)<o||l>p||parseInt(l)+parseInt(m)<p)&&($(this).hide(),q.hide())})}var c=(a.event||CONSTANTS.Events.mouseclick,"#"+(a.canvasId||CONSTANTS.canvasId)),d=null,e=null,f=null,g=null,i=null,j=null,k=null,l=null,m=$(c).height(),n=$(c).width(),o=null,p=null,q=null;b(),$(c).on("mousemove",function(a){j=j||$("#"+h.CONSTANTS.previewId),j.css("top",a.pageY-parseInt(h.VARIABLES.innerRadius)-parseInt(window.scrollY)).css("left",a.pageX-parseInt(h.VARIABLES.innerRadius)-parseInt(window.scrollX)).css("background-color",selectedAlternativeColor).css("height",2*h.VARIABLES.innerRadius).css("width",2*h.VARIABLES.innerRadius).show(),q=q||$("#"+h.CONSTANTS.previewOuterId),q.css({position:"fixed",top:a.pageY-parseInt(h.VARIABLES.outerRadius)-parseInt(window.scrollY),left:a.pageX-parseInt(h.VARIABLES.outerRadius)-parseInt(window.scrollX),"z-index":"2","border-radius":"50%",height:2*h.VARIABLES.outerRadius,width:2*h.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}).show()})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b),$("#"+h.CONSTANTS.previewId).off("mousemove"),$("#"+h.CONSTANTS.previewId).remove(),$("#"+h.CONSTANTS.previewOuterId).remove()},ContextMenu:{activate:function(b){function c(b,c){return a.generateSlider({id:b,min:1,max:200,step:1,title:c})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c("innerRadiusRing","inner radius for ring tool.").attr("value",h.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){h.VARIABLES.innerRadius=$(this).val()}).appendTo(b),c("outerRadiusRing","outer radius for ring tool.").attr("value",h.VARIABLES.outerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){h.VARIABLES.outerRadius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"RingContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:h.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:h.start,stop:h.stop,toolName:"Ring",contextMenu:h.ContextMenu,constantTitle:h.CONSTANTS.title});var i={CONSTANTS:{id:"SpeedCircleTool",selectionId:"#SpeedCircleTool","class":"main-tool",title:"Click to draw Circles. Click again to disable."},VARIABLES:{radius:4},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null,g=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=i.VARIABLES.radius,CANVASAPI.drawCircle({X:e,Y:f,innerRadius:g,outerRadius:parseInt(g)+1,strokeColor:selectedPrimaryColor})})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(){return a.generateSlider({id:"radiusSpeedCircle",min:1,max:200,step:1,title:"radius for speed circle tool"})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",e.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){e.radius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}var e=i.VARIABLES;d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedCircleContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:i.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:i.start,stop:i.stop,toolName:"Speed circle",contextMenu:i.ContextMenu,constantTitle:i.CONSTANTS.title});var j={CONSTANTS:{id:"DiscTool",selectionId:"#DiscTool","class":"main-tool",title:"Click to draw disc. Click again to disable.",previewId:"previewDisc"},VARIABLES:{radius:10},start:function(a){function b(a){$("<div></div>").attr("id",j.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(".utilities").on("click",function(a){d={event:a,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=j.VARIABLES.radius,CANVASAPI.fillCirc(e,f,g)}).on("mousemove",function(a){$(this).css("top",a.pageY-j.VARIABLES.radius-window.scrollY).css("left",a.pageX-j.VARIABLES.radius-window.scrollX).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",2*j.VARIABLES.radius).css("width",2*j.VARIABLES.radius),n=parseInt($(this).offset().left)+parseInt(j.VARIABLES.radius),o=parseInt($(this).offset().top)+parseInt(j.VARIABLES.radius),i=$(c).offset().left,k=$(c).offset().top,(i>n||parseInt(i)+parseInt(m)<n||k>o||parseInt(k)+parseInt(l)<o)&&$(this).hide()})}var c=(a.event,"#"+a.canvasId),d=null,e=null,f=null,g=null,h=null,i=$(c).offset().left,k=$(c).offset().top,l=$(c).height(),m=$(c).width(),n=null,o=null;b(),$(c).on("mousemove",function(a){h=h||$("#"+j.CONSTANTS.previewId),h.css("top",a.pageY-j.VARIABLES.radius-window.scrollY).css("left",a.pageX-j.VARIABLES.radius-window.scrollX).css("background-color",selectedPrimaryColor).css("height",2*j.VARIABLES.radius).css("width",2*j.VARIABLES.radius).show()})},stop:function(a){var b=a.event,c="#"+a.canvasId;$(c).off(b),$("#"+j.CONSTANTS.previewId).off("mousemove"),$("#"+j.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(){return a.generateSlider({id:"radiusDisc",min:1,max:200,step:1,title:"radius for disc tool."})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",j.VARIABLES.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){j.VARIABLES.radius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"DiscContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:j.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:j.start,stop:j.stop,toolName:"Disc",contextMenu:j.ContextMenu,constantTitle:j.CONSTANTS.title});var k={CONSTANTS:{id:"SpeedDiscTool",selectionId:"#SpeedDiscTool","class":"main-tool",title:"Click to draw Discs. Click again to disable."},VARIABLES:{radius:4},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null,g=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=k.VARIABLES.radius,CANVASAPI.fillCirc(e,f,g)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(){return a.generateSlider({id:"radiusSpeedDisc",min:1,max:200,step:1,title:"radius for speed disc tool"})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",e.radius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){e.radius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}var e=k.VARIABLES;d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedDiscContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:k.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:k.start,stop:k.stop,toolName:"Speed disc",contextMenu:k.ContextMenu,constantTitle:k.CONSTANTS.title});var l={CONSTANTS:{id:"SpeedDotTool",selectionId:"#SpeedDotTool","class":"main-tool",title:"Click to draw dots. Click again to disable."},VARIABLES:{},ContextMenu:{activate:function(a){},getOptions:function(){},deactivate:function(){}},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),CANVASAPI.fillCirc(e,f,1)})},stop:function(a){$("#"+a.canvasId).off(a.event)},Events:{register:function(a){var b=a.toolId,c=$(b);setupToolTips(c,l.CONSTANTS.title),a.tool=c,c.funcToggle("click",function(){activateTool(a)},function(){deactivateTool(a)})}}};a.registerEventForTool({toolId:l.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:l.start,stop:l.stop,toolName:"Speed dot",contextMenu:l.ContextMenu,constantTitle:l.CONSTANTS.title});var m={CONSTANTS:{id:"SpeedPencilTool",selectionId:"#SpeedPencilTool","class":"main-tool",title:"Click to draw draw free hand lines. Click again to disable."},VARIABLES:{width:2,LastPoint:{X:-1,Y:-1}},start:function(a){function b(a){var b=a.context,c=a.last,d=a.current,e=a.width;b.beginPath(),b.moveTo(c.X,c.Y),b.lineTo(d.X,d.Y),b.lineWidth=e,b.strokeStyle=selectedPrimaryColor,b.stroke()}var c=a.event,d="#"+a.canvasId,e=null,f=null,g=null,h=null,i=null,j={get:function(){return{X:m.VARIABLES.LastPoint.X,Y:m.VARIABLES.LastPoint.Y}},set:function(a,b){m.VARIABLES.LastPoint.X=a,m.VARIABLES.LastPoint.Y=b}};$(d).on(c,function(a){e={event:a,relativeTo:$(this)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=m.VARIABLES.width,i=j.get(),-1!=i.X&&b({context:context,last:i,current:{X:f,Y:g},width:h}),CANVASAPI.fillCirc(f,g,h/2),j.set(f,g)})},stop:function(a){m.VARIABLES.LastPoint.X=-1,m.VARIABLES.LastPoint.Y=-1,$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(){return a.generateSlider({id:"widthSpeedPencil",min:1,max:200,step:1,title:"width for speed pencil tool."})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c().attr("value",m.VARIABLES.width).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){m.VARIABLES.width=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedPencilContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:m.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:m.start,stop:m.stop,toolName:"Speed pencil",contextMenu:m.ContextMenu,constantTitle:m.CONSTANTS.title});var n={CONSTANTS:{id:"SpeedRectangleTool",selectionId:"#SpeedRectangleTool","class":"main-tool",title:"Click to draw speed rectangles. Click again to disable."},VARIABLES:{length:20,breadth:10},start:function(a){var b=(a.event,"#"+a.canvasId);$(b).on("mousemove",function(a){var c={event:a,relativeTo:$(b)},d=Actions.Mouse.getX(c),e=Actions.Mouse.getY(c),f=n.VARIABLES.length,g=n.VARIABLES.breadth;context.fillRect(d-f/2,e-g/2,f,g)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c){return a.generateSlider({id:b,min:1,max:200,step:1,title:c})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c(a.lengthId,a.lengthTitle).attr("value",n.VARIABLES.length).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){n.VARIABLES.length=$(this).val()}).appendTo(b),c(a.breadthId,a.breadthTitle).attr("value",n.VARIABLES.breadth).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){n.VARIABLES.breadth=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.lengthId).remove(),$("#"+a.breadthId).remove()}b(a),$("#"+n.CONSTANTS.previewId).off("mousemove"),$("#"+n.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"SpeedRectangleContextMenu",lengthId:"lengthSpeedRectangle",breadthId:"breadthSpeedRectangle",lengthTitle:"length for speed rectangle",breadthTitle:"breadth for speed rectangle",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:n.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:n.start,stop:n.stop,toolName:"Speed rectangle",contextMenu:n.ContextMenu,constantTitle:n.CONSTANTS.title});var o={CONSTANTS:{id:"SpeedRingTool",selectionId:"#SpeedRingTool","class":"main-tool",title:"Click to draw speed rings. Click again to disable."},VARIABLES:{innerRadius:10,outerRadius:20},start:function(a){var b=a.event,c="#"+a.canvasId,d=null,e=null,f=null,g=null,h=null;$(c).on(b,function(a){d={event:a,relativeTo:$(this)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=o.VARIABLES.innerRadius,h=o.VARIABLES.outerRadius,CANVASAPI.fillRing({X:e,Y:f,innerRadius:g,outerRadius:h,strokeColor:selectedPrimaryColor,fillColor:selectedAlternativeColor})})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c){return a.generateSlider({id:b,min:1,max:200,step:1,title:c})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item");c("innerRadiusSpeedRing","inner radius for speed ring tool.").attr("value",o.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){o.VARIABLES.innerRadius=$(this).val()}).appendTo(b),c("outerRadiusSpeedRing","outer radius for speed ring tool.").attr("value",o.VARIABLES.outerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){o.VARIABLES.outerRadius=$(this).val()}).appendTo(b);b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){
function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedRingContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:o.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:o.start,stop:o.stop,toolName:"Speed ring",contextMenu:o.ContextMenu,constantTitle:o.CONSTANTS.title});var p={CONSTANTS:{id:"SpeedSquareTool",selectionId:"#SpeedSquareTool","class":"main-tool",title:"Click to draw speed squares. Click again to disable."},VARIABLES:{side:10,xyPlaneRotationAngle:360},start:function(a){var b=(a.event,"#"+a.canvasId);$(b).on("mousemove",function(a){var c={event:a,relativeTo:$(b)},d=Actions.Mouse.getX(c),e=Actions.Mouse.getY(c),f=p.VARIABLES.side,g=p.VARIABLES.xyPlaneRotationAngle*Math.PI/180;CANVASAPI.fillRoatedSquare(d-f/2,e-f/2,f,g)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c,d){return a.generateSlider({id:b,min:10,max:d,step:1,title:c})}function d(a){var b=$("#"+a.id);return 0===b.length?$("<div></div>").attr("id",a.id).addClass("menu-item"):b}function e(b){function d(a){return c("sideSpeedSquare","side length for square tool",200).attr("value",p.VARIABLES.side).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){p.VARIABLES.side=$(this).val()})}return a.genericLabel().append(b.sideLabel).append(d(b))}function f(b){function d(a){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360).attr("value",p.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){p.VARIABLES.xyPlaneRotationAngle=$(this).val()})}return a.genericLabel().append(b.xyPlaneRotationAngle).append(d(b))}var g=d(b);e(b).appendTo(g),f(b).appendTo(g),g.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"SpeedSquareToolContextMenu",containerSelectionCriterion:".contextual-tool-bar",xyPlaneRotationAngle:"xy plane rotation angle: ",sideLabel:"side length: "}}}};a.registerEventForTool({toolId:p.CONSTANTS.selectionId,event:CONSTANTS.Events.mousemove,canvasId:CONSTANTS.canvasId,start:p.start,stop:p.stop,toolName:"Speed square",contextMenu:p.ContextMenu,constantTitle:p.CONSTANTS.title});var q={CONSTANTS:{id:"SquareTool",selectionId:"#SquareTool","class":"main-tool",title:"Click to draw squares. Click again to disable.",previewId:"previewSquare"},VARIABLES:{side:10,xyPlaneRotationAngle:360},start:function(a){function b(a){$("<div></div>").attr("id",q.CONSTANTS.previewId).css({position:"fixed","z-index":"2"}).appendTo(".utilities").on("click",function(a){var b={event:a,relativeTo:$(c)},d=Actions.Mouse.getX(b),e=Actions.Mouse.getY(b),f=q.VARIABLES.side,g=q.VARIABLES.xyPlaneRotationAngle*Math.PI/180;CANVASAPI.fillRoatedSquare(d-f/2,e-f/2,f,g)}).on("mousemove",function(a){$(this).css("top",parseInt(a.pageY)-parseInt(q.VARIABLES.side/2)-parseInt(window.scrollY)).css("left",parseInt(a.pageX)-parseInt(parseInt(q.VARIABLES.side/2))-parseInt(window.scrollX)).css("background-color",selectedPrimaryColor).css("border","thin dashed "+selectedAlternativeColor).css("height",q.VARIABLES.side).css("width",q.VARIABLES.side),i=parseInt($(this).offset().left)+parseInt(q.VARIABLES.side/2),j=parseInt($(this).offset().top)+parseInt(q.VARIABLES.side/2),e=$(c).offset().left,f=$(c).offset().top,(e>i||parseInt(e+h)<i||f>j||parseInt(f+g)<j)&&$(this).hide()})}var c=(a.event||CONSTANTS.Events.mouseclick,"#"+(a.canvasId||CONSTANTS.canvasId)),d=null,e=$(c).offset().left,f=$(c).offset().top,g=$(c).height(),h=$(c).width(),i=null,j=null;b(),$(c).on("mousemove",function(a){d=d||$("#"+q.CONSTANTS.previewId),d.css("top",a.pageY-parseInt(q.VARIABLES.side/2)-window.scrollY).css("left",a.pageX-parseInt(q.VARIABLES.side/2)-window.scrollX).css("background-color",selectedPrimaryColor).css("height",q.VARIABLES.side).css("width",q.VARIABLES.side).css("transform","rotate("+parseInt(q.VARIABLES.xyPlaneRotationAngle*Math.PI)/180+"rad)").show()})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b)},ContextMenu:{activate:function(b){function c(b,c,d,e){return a.generateSlider({id:b,min:e,max:d,step:1,title:c})}function d(a){var b=$("#"+a.id);return 0===b.length?$("<div></div>").attr("id",a.id).addClass("menu-item"):b}function e(a){return c("sideSquare","side length for square tool",200,10).attr("value",q.VARIABLES.side).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){q.VARIABLES.side=$(this).val()})}function f(a){return c("xyPlaneRotationAngle","rotation angle for XY plane rotation.",360,0).attr("value",q.VARIABLES.xyPlaneRotationAngle).on("mouseover",function(){$(this).attr("title",$(this).val()+" deg")}).on("input",function(){q.VARIABLES.xyPlaneRotationAngle=$(this).val()})}var g=d(b);e(b).appendTo(g),f(b).appendTo(g),g.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a),$("#"+q.CONSTANTS.previewId).off("mousemove"),$("#"+q.CONSTANTS.previewId).remove()},getOptions:function(){return{tool:this,id:"SquareToolContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:q.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:q.start,stop:q.stop,toolName:"Square",contextMenu:q.ContextMenu,constantTitle:q.CONSTANTS.title});var r={CONSTANTS:{id:"CircleTool",selectionId:"#CircleTool","class":"main-tool",title:"Click to draw circle. Click again to disable.",previewId:"previewCircle"},VARIABLES:{innerRadius:10},start:function(a){function b(a){$("<div></div>").attr("id",r.CONSTANTS.previewId).css({position:"fixed","z-index":"2","border-radius":"50%"}).appendTo(".utilities").on("click",function(a){d={event:a,relativeTo:$(c)},e=Actions.Mouse.getX(d),f=Actions.Mouse.getY(d),g=r.VARIABLES.innerRadius,h=parseInt(r.VARIABLES.innerRadius)+1,CANVASAPI.drawCircle({X:e,Y:f,innerRadius:g,outerRadius:h,strokeColor:selectedPrimaryColor})}).on("mousemove",function(a){$(this).css("top",a.pageY-r.VARIABLES.innerRadius-window.scrollY).css("left",a.pageX-r.VARIABLES.innerRadius-window.scrollX).css("border","thin solid "+selectedPrimaryColor).css("height",2*r.VARIABLES.innerRadius).css("width",2*r.VARIABLES.innerRadius),n=parseInt($(this).offset().left)+parseInt(r.VARIABLES.innerRadius),o=parseInt($(this).offset().top)+parseInt(r.VARIABLES.innerRadius),j=$(c).offset().left,k=$(c).offset().top,(j>n||parseInt(j)+parseInt(m)<n||k>o||parseInt(k)+parseInt(l)<o)&&$(this).hide()})}var c=(a.event||CONSTANTS.Events.mouseclick,"#"+(a.canvasId||CONSTANTS.canvasId)),d=null,e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=$(c).height(),m=$(c).width(),n=null,o=null;b(),$(c).on("mousemove",function(a){i=i||$("#"+r.CONSTANTS.previewId),i.css("top",a.pageY-r.VARIABLES.innerRadius-window.scrollY).css("left",a.pageX-r.VARIABLES.innerRadius-window.scrollX).css("border","thin solid "+selectedPrimaryColor).css("height",2*r.VARIABLES.innerRadius).css("width",2*r.VARIABLES.innerRadius).show()})},stop:function(a){var b=a.event||CONSTANTS.Events.mouseclick,c="#"+(a.canvasId||CONSTANTS.canvasId);$(c).off(b),$("#"+r.CONSTANTS.previewId).off("mousemove"),$("#"+r.CONSTANTS.previewId).remove()},ContextMenu:{activate:function(b){function c(b,c){return a.generateSlider({id:b,min:1,max:200,step:1,title:c})}function d(a){var b=$("<div></div>").attr("id",a.id).addClass("menu-item"),d=c("radiusCircle","innerRadius for circle tool.").attr("value",r.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){r.VARIABLES.innerRadius=$(this).val()});d.appendTo(b),b.appendTo($(a.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"CircleContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}}};a.registerEventForTool({toolId:r.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:r.start,stop:r.stop,toolName:"Circle",contextMenu:r.ContextMenu,constantTitle:r.CONSTANTS.title});var s={CONSTANTS:{id:"FamilyPointWalkerTool",selectionId:"#FamilyPointWalkerTool","class":"main-tool",title:"Click to draw family random point walker. Click again to disable."},VARIABLES:{steps:100,durationBetweenDanceStepsInMiliSeconds:100},start:function(a){var b,c,d=a.event,e="#"+a.canvasId,f=null,g=null,h=null,i=0,j=[],k={};$(e).on(d,function(a){function d(a){for(g=a.X,h=a.Y,b=a.steps,c=a.fillColor,i=0;b>i;i++)j[i]={X:g,Y:h},context.fillStyle=c,CANVASAPI.fillCirc(g,h,1),g+=Math.random()<.5?-1:1,h-=Math.random()<.5?-1:1;setTimeout(function(){d(a)},1e3)}f={event:a,relativeTo:$(e)},g=Actions.Mouse.getX(f),h=Actions.Mouse.getY(f),k={X:g,Y:h,steps:s.VARIABLES.steps,fillColor:selectedPrimaryColor},setTimeout(function(){d(k)},1e3)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c,d,e){return a.generateSlider({id:b,min:c,max:d,step:1,title:e})}function d(b){function d(a){var b=c("familyPointWalkerSptes",s.VARIABLES.steps,a.maxStepsAllowed,"Steps for family random point walk generation.").attr("value",s.VARIABLES.steps).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){s.VARIABLES.steps=$(this).val()});return b}return a.genericLabel().append(b.stepLabel).append(d(b))}var e=$("<div></div>").attr("id",b.id).addClass("menu-item");e.append(d(b)),e.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){$("#"+a.id).remove()},getOptions:function(){return{tool:this,id:"FamilyPointWalkerContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxStepsAllowed:1e5,stepLabel:"Steps: "}}}};a.registerEventForTool({toolId:s.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:s.start,stop:s.stop,toolName:"Family Point Walker",contextMenu:s.ContextMenu,constantTitle:s.CONSTANTS.title});var t={CONSTANTS:{id:"OrganismPointWalkerTool",selectionId:"#OrganismPointWalkerTool","class":"main-tool",title:"Click to draw organism random point walker. Click again to disable."},VARIABLES:{steps:100,durationBetweenDanceStepsInMiliSeconds:100},start:function(a){var b,c,d=a.event,e="#"+a.canvasId,f=null,g=null,h=null,i=0,j=[],k={};$(e).on(d,function(a){function d(a){for(g=a.X,h=a.Y,b=a.steps,c=a.fillColor,i=0;b>i;i++)j[i]={X:g,Y:h},context.fillStyle=c,CANVASAPI.fillCirc(g,h,1),g+=Math.random()<.5?-1:1,h-=Math.random()<.5?-1:1;a.X=g,a.Y=h,setTimeout(function(){d(a)},1e3)}f={event:a,relativeTo:$(e)},g=Actions.Mouse.getX(f),h=Actions.Mouse.getY(f),k={X:g,Y:h,steps:t.VARIABLES.steps,fillColor:selectedPrimaryColor},setTimeout(function(){d(k)},1e3)})},stop:function(a){$("#"+a.canvasId).off(a.event)},ContextMenu:{activate:function(b){function c(b,c,d,e){return a.generateSlider({id:b,min:c,max:d,step:1,title:e})}function d(b){function d(a){var b=c("organismPointWalkerSptes",t.VARIABLES.steps,a.maxStepsAllowed,"Steps for organism random point walk generation.").attr("value",t.VARIABLES.steps).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("change",function(){t.VARIABLES.steps=$(this).val()});return b}return a.genericLabel().append(b.stepLabel).append(d(b))}var e=$("<div></div>").attr("id",b.id).addClass("menu-item");e.append(d(b)),e.appendTo($(b.containerSelectionCriterion))},deactivate:function(a){$("#"+a.id).remove()},getOptions:function(){return{tool:this,id:"OrganismPointWalkerContextMenu",containerSelectionCriterion:".contextual-tool-bar",maxStepsAllowed:1e4,stepLabel:"Steps: "}}}};a.registerEventForTool({toolId:t.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:t.start,stop:t.stop,toolName:"Organism Point Walker",contextMenu:t.ContextMenu,constantTitle:t.CONSTANTS.title})});