/*! jspaint 2015-07-08 Anubhav Saini (c) 2015 */
$(function(){"use strict";var a={CONSTANTS:{id:"RingTool",selectionId:"#RingTool","class":"main-tool",title:"Click to draw ring. Click again to disable.",previewId:"previewRing",previewOuterId:"previewOuterRing"},VARIABLES:{innerRadius:10,outerRadius:20},start:function(b){function c(b){var c=$("<div></div>").attr("id",a.CONSTANTS.previewOuterId).css({position:"fixed","z-index":"100","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"backgruond-color":selectedPrimaryColor}).appendTo(".utilities");$("<div></div>").attr("id",a.CONSTANTS.previewId).css({position:"fixed","z-index":"100","border-radius":"50%"}).appendTo(c).on("click",function(b){e={event:b,relativeTo:$(d)},f=Actions.Mouse.getX(e),g=Actions.Mouse.getY(e),h=a.VARIABLES.innerRadius,i=a.VARIABLES.outerRadius,CANVASAPI.fillRing({X:f,Y:g,innerRadius:h,outerRadius:i,strokeColor:selectedPrimaryColor,fillColor:selectedAlternativeColor})}).on("mousemove",function(b){$(this).css("top",b.pageY-parseInt(a.VARIABLES.innerRadius)-parseInt(scrollY)).css("left",b.pageX-parseInt(a.VARIABLES.innerRadius)-parseInt(scrollX)).css("background-color",selectedAlternativeColor).css("border","thin dashed "+selectedPrimaryColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius),q.css({position:"fixed",top:b.pageY-parseInt(a.VARIABLES.outerRadius)-parseInt(scrollY),left:b.pageX-parseInt(a.VARIABLES.outerRadius)-parseInt(scrollX),"z-index":"100","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}),o=$(this).offset().left+parseInt(a.VARIABLES.innerRadius),p=$(this).offset().top+parseInt(a.VARIABLES.innerRadius),k=$(d).offset().left,l=$(d).offset().top,(k>o||parseInt(k)+parseInt(n)<o||l>p||parseInt(l)+parseInt(m)<p)&&($(this).hide(),q.hide())})}var d=(b.event||CONSTANTS.Events.mouseclick,"#"+(b.canvasId||CONSTANTS.canvasId)),e=null,f=null,g=null,h=null,i=null,j=null,k=null,l=null,m=$(d).height(),n=$(d).width(),o=null,p=null,q=null;c(),$(d).on("mousemove",function(b){j=j||$("#"+a.CONSTANTS.previewId),j.css("top",b.pageY-parseInt(a.VARIABLES.innerRadius)-parseInt(scrollY)).css("left",b.pageX-parseInt(a.VARIABLES.innerRadius)-parseInt(scrollX)).css("background-color",selectedAlternativeColor).css("height",2*a.VARIABLES.innerRadius).css("width",2*a.VARIABLES.innerRadius).show(),q=q||$("#"+a.CONSTANTS.previewOuterId),q.css({position:"fixed",top:b.pageY-parseInt(a.VARIABLES.outerRadius)-parseInt(scrollY),left:b.pageX-parseInt(a.VARIABLES.outerRadius)-parseInt(scrollX),"z-index":"100","border-radius":"50%",height:2*a.VARIABLES.outerRadius,width:2*a.VARIABLES.outerRadius,"background-color":selectedPrimaryColor}).show()})},stop:function(b){var c=b.event||CONSTANTS.Events.mouseclick,d="#"+(b.canvasId||CONSTANTS.canvasId);$(d).off(c),$("#"+a.CONSTANTS.previewId).off("mousemove"),$("#"+a.CONSTANTS.previewId).remove(),$("#"+a.CONSTANTS.previewOuterId).remove()},ContextMenu:{activate:function(b){function c(a,b){return $('<input id="'+a+'" type="range" min="1" max="200" step="1" title="'+b+'" />')}function d(b){var d=$("<div></div>").attr("id",b.id).addClass("menu-item");c("innerRadiusRing","inner radius for ring tool.").attr("value",a.VARIABLES.innerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.innerRadius=$(this).val()}).appendTo(d),c("outerRadiusRing","outer radius for ring tool.").attr("value",a.VARIABLES.outerRadius).on("mouseover",function(){$(this).attr("title",$(this).val())}).on("input",function(){a.VARIABLES.outerRadius=$(this).val()}).appendTo(d);d.appendTo($(b.containerSelectionCriterion))}d(b)},deactivate:function(a){function b(a){$("#"+a.id).remove()}b(a)},getOptions:function(){return{tool:this,id:"RingContextMenu",containerSelectionCriterion:".contextual-tool-bar"}}},Events:{register:function(b){var c=b.toolId||a.CONSTANTS.selectionId,d=$(c),e=a.ContextMenu;setupToolTips(d,a.CONSTANTS.title),b.tool=d,d.funcToggle("click",function(){activateTool(b),e.activate(e.getOptions()),activeTool=d},function(){activeTool=null,deactivateTool(b),e.deactivate(e.getOptions())})}}};a.Events.register({toolId:a.CONSTANTS.selectionId,event:CONSTANTS.Events.mouseclick,canvasId:CONSTANTS.canvasId,start:a.start,stop:a.stop})});